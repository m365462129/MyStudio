--- 3D 麻将金币场模式
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by YHZ
--- DateTime: 2018/5/8 11:30
---

local class = require("lib.middleclass")
---@type TableTypeGold
local Base = require('package.majiang.module.tablenew.roomtype.table_type_gold')
---@class Table3dTypeGold:TableTypeGold
---@field view TableCommonView
local Table3dTypeGold = class('table3dTypeGold', Base)
local ModuleCache = ModuleCache
local GetComponentWithPath = ModuleCache.ComponentUtil.GetComponentWithPath
local ComponentTypeName = ModuleCache.ComponentTypeName
local Vector3 = Vector3
local ModuleCache = ModuleCache
local Util = Util

function Table3dTypeGold:on_initialize()
    Base.on_initialize(self)
    self.Mj3dCenterCom = self.view.Mj3dCenterCom
    self.Mj3dCenterCom:switchDisableTagType(self.Mj3dCenterCom.disableStyle.gold)
end

--- 显示局数
function Table3dTypeGold:show_round(gameState)
    Base.show_round(self,gameState)
    self.view.jushu.text = "底分:"..tostring(gameState.BaseCoinScore)
end

---进入拦牌状态
function Table3dTypeGold:on_game_state_wait_action()
    Base.on_game_state_wait_action(self)
    self.view:begin_time_down(15, function (t)
        if not self.view.gameState then
            return
        end
        self.view:show_time_down(t)
        if(t == 3) then
            if(self.view.gameState.Result == 0) then
                self.view:play_voice("common/timedown")
            end
        end
        if t == 0 and self.view.gameState and  self.view.gameState.KeChu then
            if(self.view.openShake) then
                ModuleCache.GameSDKInterface:ShakePhone(1000)
            end
        end
    end)
end

return Table3dTypeGold